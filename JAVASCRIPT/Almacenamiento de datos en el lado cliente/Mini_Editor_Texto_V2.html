<!DOCTYPE html>
<html>

<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<title>Plantilla</title>

	<style type="text/css">
		#texto {
			width: 700px;
			height: 500px;
			border: 1px solid blue;
			padding: 0.4em;
		}

		span {
			border: 2px solid red;
			margin: 1.1em;
			padding: .2em;
			cursor: pointer;
			background-color: pink;
		}
	</style>

	<script type="text/javascript">
		window.onload = function () {
			document.getElementById("negrita").onmousedown = negrita;
			document.getElementById("cursiva").onmousedown = cursiva;
			document.getElementById("subrayado").onmousedown = subrayado;
			document.getElementById("color").onmousedown = color;
			document.getElementById("guardar").onclick = guardarFrase;
			nombreTextos();

			var nt1 = document.getElementById("nombre_texto").value;
			var guarda = localStorage.getItem(nt1);
			if (guarda) {
				document.getElementById("texto").innerHTML = guarda;
			}
		}

		function negrita(e) {
			document.execCommand('bold', false, null);
			e.preventDefault();
		}

		function cursiva(e) {
			document.execCommand('italic', false, null);
			e.preventDefault();
		}

		function subrayado(e) {
			document.execCommand('underline', false, null);
			e.preventDefault();
		}

		function color(e) {
			document.execCommand('foreColor', false, 'red');
			e.preventDefault();
		}

		function guardarFrase() {
			var t = document.getElementById("texto").innerHTML;
			var nt = document.getElementById("nombre_texto").value;
			if (nt === "" || nt.trim() === "") {
				alert("Introduce un nombre para el texto.");
				return;
			}
			localStorage.setItem(nt, t);
			document.getElementById("sal").innerHTML = "Texto guardado.";
		}

		function nombreTextos(){
			var select = document.getElementById("textos_guardados");
			select.innerHTML = "<option value=''>Selecciona un texto</option>";

			for(var i = 0; i < localStorage.length; i++){
				var nombre = localStorage.key(i);
				var opcion = document.createElement("option");
				opcion.value = nombre;
				opcion.textContent = nombre;
				select.appendChild(opcion);
			}

			select.onchange = function(){
				var n = this.value;
				if(n){
					var textGuard = localStorage.getItem(n);
					document.getElementById("texto").innerHTML = textGuard;
					document.getElementById("nombre_texto").value = n;
				}
			};
		}

	</script>
</head>

<body>

	<h3>Procesador de Textos</h3>
	<label for="nombre_texto">Nombre del texto:</label>
	<input type="text" id="nombre_texto">
	<label for="textos_guardados">Textos guardados:</label>
	<select id="textos_guardados" name="textos_guardados">
	</select>
	<p>
		<span id="guardar">Guardar</span>
		<span id="negrita">Negrita</span>
		<span id="cursiva">Cursiva</span>
		<span id="subrayado">Subrayado</span>
		<span id="color">Color</span>
	</p>
	<div id="texto" contentEditable="true" spellcheck="true">
		Esto es un texto de prueba para no tener que estar escribiendo.
	</div>
	<p id="sal"></p>

</body>

</html>